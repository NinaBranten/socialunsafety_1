---
title: "LCA_schaal3_29923"
output: html_document
date: "2025-03-12"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(cache=TRUE, echo = TRUE)
```


```{r, globalsettings, echo=FALSE, warning=FALSE, results='hide'}
library(knitr)

knitr::opts_chunk$set(echo = TRUE)
opts_chunk$set(tidy.opts=list(width.cutoff=100),tidy=TRUE, warning = FALSE, message = FALSE,comment = "#>", cache=TRUE, class.source=c("test"), class.output=c("test2"))
options(width = 100)
rgl::setupKnitr()




colorize <- function(x, color) {sprintf("<span style='color: %s;'>%s</span>", color, x) }

```



```{r klippy20, echo=FALSE, include=TRUE}
klippy::klippy(position = c('top', 'right'))
#klippy::klippy(color = 'darkred')
#klippy::klippy(tooltip_message = 'Click to copy', tooltip_success = 'Done')
```


```{r}
library("formatR")
library("foreign")
library("ggplot2")
library("lme4")
library("poLCA")
library("reprex")
library("tidyr")
library("klippy")
library("dplyr")
library("haven")
library("psych")
```


```{r klippy21, echo=FALSE, include=TRUE, results='hide', warning=FALSE, message=FALSE}
NEA2022_clust1 <-read.spss("data/processed/NEA2022_clust1.sav", use.value.labels = T, to.data.frame = T)
attach(NEA2022_clust1)
set.seed(123)
```

```{r klippy22, echo=FALSE, include=TRUE, results='hide', warning=FALSE, message=FALSE}
summarytools::freq(NEA2022_clust1$steunleid_aandacht)
summarytools::freq(NEA2022_clust1$steunleid_welzijn)
NEA2022_clust1$steunleid_scale <- rowMeans(NEA2022_clust1[c("steunleid_aandacht", "steunleid_welzijn")], na.rm = TRUE)
summarytools::freq(NEA2022_clust1$steunleid_scale)
summarytools::freq(NEA2022_clust1$afl_socs)

NEA2022_clust1 <- NEA2022_clust1 %>%
  mutate(steunleid_RR = case_when(
    steunleid_scale %in% c(1) ~ 1,
    steunleid_scale %in% c(1.5, 2) ~ 2,
    steunleid_scale %in% c(2.5, 3) ~ 3,
    steunleid_scale %in% c(3.5, 4) ~ 4,
    TRUE ~ NA_real_
  ))

summarytools::freq(NEA2022_clust1$steunleid_scale)
summarytools::freq(NEA2022_clust1$steunleid_RR)
mean(NEA2022_clust1$steunleid_RR, na.rm=TRUE)
sd(NEA2022_clust1$steunleid_RR, na.rm=TRUE)

summarytools::freq(NEA2022_clust1$steuncol_belang)
summarytools::freq(NEA2022_clust1$steuncol_vriendelijk)
NEA2022_clust1$steuncol_scale <- rowMeans(NEA2022_clust1[c("steuncol_belang", "steuncol_vriendelijk")], na.rm = TRUE)
summarytools::freq(NEA2022_clust1$steuncol_scale)
summarytools::freq(NEA2022_clust1$afl_so_2)

NEA2022_clust1 <- NEA2022_clust1 %>%
  mutate(steuncol_RR = case_when(
    steuncol_scale %in% c(1) ~ 1,
    steuncol_scale %in% c(1.5, 2) ~ 2,
    steuncol_scale %in% c(2.5, 3) ~ 3,
    steuncol_scale %in% c(3.5, 4) ~ 4,
    TRUE ~ NA_real_
  ))

summarytools::freq(NEA2022_clust1$steuncol_scale)
summarytools::freq(NEA2022_clust1$steuncol_RR)
mean(NEA2022_clust1$steuncol_RR, na.rm=TRUE)
sd(NEA2022_clust1$steuncol_RR, na.rm=TRUE)
```

```{r klippy23, echo=FALSE, include=TRUE, results='hide', warning=FALSE, message=FALSE}
attach(NEA2022_clust1)
psyveil <- data.frame(psyveil_last, psyveil_hulp, psyveil_fout)

alpha_result <- alpha(psyveil)

print(alpha_result)

raw_alpha_value <- alpha_result$total$raw_alpha
print(raw_alpha_value)
```

```{r klippy24, echo=FALSE, include=TRUE, results='hide', warning=FALSE, message=FALSE}
NEA2022_clust1$psyveil_scale <- rowMeans(NEA2022_clust1[c("psyveil_last", "psyveil_hulp", "psyveil_fout")], na.rm = TRUE)

summarytools::freq(NEA2022_clust1$psyveil_scale)

NEA2022_clust1$psyveil_R <- as.numeric(factor(NEA2022_clust1$psyveil_scale))

summarytools::freq(NEA2022_clust1$psyveil_R)

NEA2022_clust1$psyveil_R[NEA2022_clust1$psyveil_R == "18"] <- NA


summarytools::freq(NEA2022_clust1$psyveil_scale)
summarytools::freq(NEA2022_clust1$psyveil_R)

NEA2022_clust1 <- NEA2022_clust1 %>%
  mutate(psyveil_RR = case_when(
    psyveil_R %in% c(1, 2) ~ 1,
    psyveil_R %in% c(3, 4, 5, 6) ~ 2,
    psyveil_R %in% c(7, 8, 9, 10) ~ 3,
    psyveil_R %in% c(11, 12, 13, 14) ~ 4,
    psyveil_R %in% c(15, 16, 17) ~ 5,
    TRUE ~ NA_real_
  ))
summarytools::freq(NEA2022_clust1$psyveil_scale)
summarytools::freq(NEA2022_clust1$psyveil_RR)
mean(NEA2022_clust1$psyveil_RR, na.rm=TRUE)
sd(NEA2022_clust1$psyveil_RR, na.rm=TRUE)
attach(NEA2022_clust1)
```

```{r}
NEA2022_clust1$afl_soi3[NEA2022_clust1$afl_soi3 == "onbekend"] <- NA

NEA2022_clust1_29923 <- NEA2022_clust1 %>%
  filter(!is.na(afl_soi3))
```

```{r}
#write.csv(NEA2022_clust1_29923, "data/processed/NEA2022_clust1_29923.sav")
```


```{r}
set.seed(123)
```

```{r, cache=TRUE, warning=FALSE}
attach(NEA2022_clust1_29923)
data_emp <- data.frame(pesten_col, pesten_leid, intimidation_col, intimidation_leid, geweld_col, geweld_leid, seks_col, seks_leid, conflict_col, conflict_leid, steunleid_RR, steuncol_RR, psyveil_RR)

items_emp <- cbind(pesten_col, pesten_leid, intimidation_col, intimidation_leid, geweld_col, geweld_leid, seks_col, seks_leid, conflict_col, conflict_leid, steunleid_RR, steuncol_RR, psyveil_RR) ~ 1
```
<br><br> Variabelen:

<br><br> Pesten_col: **pesten door collega's.** (1) niet (2) een enkele keer (3) vaak (4) zeer vaak
<br><br> Pesten_leid: **pesten door leidinggevenden.** (1) niet (2) een enkele keer (3) vaak (4) zeer vaak
<br><br> Intimidation_col: **intimidatie door collega's.** (1) niet (2) een enkele keer (3) vaak (4) zeer vaak
<br><br> Intimidation_leid: *intimidatie door leidinggevenden.* (1) niet (2) een enkele keer (3) vaak (4) zeer vaak
<br><br> Geweld_col: **fysiek geweld door collega's.** (1) niet (2) een enkele keer (3) vaak (4) zeer vaak
<br><br> Geweld_leid: **fysiek geweld door leidinggevenden.** (1) niet (2) een enkele keer (3) vaak (4) zeer vaak
<br><br> Seks_col: **ongewenste seksuele aandacht collega's.** (1) niet (2) een enkele keer (3) vaak (4) zeer vaak
<br><br> Seks_leid: **ongewenste seksuele aandacht leidinggevenden.** (1) niet (2) een enkele keer (3) vaak (4) zeer vaak
<br><br> Conflict_col: **conflict collega's.** (1) nee (2) ja, kortdurend (3) ja, langdurend
<br><br> Conflict_leid: **conflict leidinggevenden.** (1) nee (2) ja, kortdurend (3) ja, langdurend
<br><br> Steunleid_RR: **mijn leidinggevende besteedt aandacht aan wat ik zeg.** **mijn leidinggevende heeft oog voor het welzijn van de medewerker.** Gemiddelde score van deze twee items. Afgerond (1) helemaal mee eens (2) mee eens (3) mee oneens (4) helemaal mee oneens
<br><br> Steuncol_RR: **mijn collega's hebben persoonlijke belangstelling voor me.** **mijn collega's zijn vriendelijk.** Gemiddelde score van deze twee items.  Afgerond (1) helemaal mee eens (2) mee eens (3) mee oneens (4) helemaal mee oneens
<br><br> Psyveil_RR: **op mijn werk kun je lastige kwesties naar voren brengen.** **op mijn werk is het gemakkelijk om hulp te vragen.** **op mijn werk is het niet erg om een fout te maken.** Gemiddelde score van deze drie items. Afgerond (1) Helemaal eens (2) eens (3) niet eens, niet oneens (4) niet eens (5) helemaal niet eens



```{r, cache=TRUE}
model1_emp <- poLCA(items_emp, data_emp, nclass = 1, maxiter = 5000, nrep = 10, graphs=FALSE, na.rm = FALSE)
```

```{r, cache=TRUE}
model2_emp <- poLCA(items_emp, data_emp, nclass = 2, maxiter = 5000, nrep = 10, graphs=FALSE, na.rm = FALSE)
```

```{r, cache=TRUE}
model3_emp <- poLCA(items_emp, data_emp, nclass = 3, maxiter = 5000, nrep = 10, graphs=FALSE, na.rm = FALSE)
```

```{r, cache=TRUE}
model4_emp <- poLCA(items_emp, data_emp, nclass = 4, maxiter = 5000, nrep = 10, graphs=FALSE, na.rm = FALSE)
```

```{r, cache=TRUE}
model5_emp <- poLCA(items_emp, data_emp, nclass = 5, maxiter = 5000, nrep = 10, graphs=FALSE, na.rm = FALSE)
```

```{r, cache=TRUE}
model6_emp <- poLCA(items_emp, data_emp, nclass = 6, maxiter = 5000, nrep = 10, graphs=FALSE, na.rm = FALSE)
```

```{r, cache=TRUE}
model7_emp <- poLCA(items_emp, data_emp, nclass = 7, maxiter = 5000, nrep = 10, graphs=FALSE, na.rm = FALSE)
model7_emp
```

```{r, cache=TRUE}
model8_emp <- poLCA(items_emp, data_emp, nclass = 8, maxiter = 5000, nrep = 10, graphs=FALSE, na.rm = FALSE)
```

```{r, cache=TRUE}
model9_emp <- poLCA(items_emp, data_emp, nclass = 9, maxiter = 5000, nrep = 10, graphs=FALSE, na.rm = FALSE)
```

```{r, cache=TRUE}
model10_emp <- poLCA(items_emp, data_emp, nclass = 10, maxiter = 5000, nrep = 10, graphs=FALSE, na.rm = FALSE)
```

```{r, cache=TRUE}
model11_emp <- poLCA(items_emp, data_emp, nclass = 11, maxiter = 5000, nrep = 10, graphs=FALSE, na.rm = FALSE)
```

```{r, cache=TRUE}
model12_emp <- poLCA(items_emp, data_emp, nclass = 12, maxiter = 5000, nrep = 10, graphs=FALSE, na.rm = FALSE)
```

```{r, cache=TRUE}
model13_emp <- poLCA(items_emp, data_emp, nclass = 13, maxiter = 5000, nrep = 10, graphs=FALSE, na.rm = FALSE)
```



```{r, cache=TRUE}
model14_emp <- poLCA(items_emp, data_emp, nclass = 14, maxiter = 5000, nrep = 10, graphs=FALSE, na.rm = FALSE)
```

```{r, eval=FALSE}
model3_emppred <- model3_emp$predclass
model3_emppost <- model3_emp$posterior

lposteriorsmodel3_emp <- as.list(as.data.frame(model3_emppost))

pmodel3_empv1 <- lposteriorsmodel3_emp[[1]]
pmodel3_empv2 <- lposteriorsmodel3_emp[[2]]
pmodel3_empv3 <- lposteriorsmodel3_emp[[3]]

model4_emppred <- model4_emp$predclass
model4_emppost <- model4_emp$posterior

lposteriorsmodel4_emp <- as.list(as.data.frame(model4_emppost))

pmodel4_empv1 <- lposteriorsmodel4_emp[[1]]
pmodel4_empv2 <- lposteriorsmodel4_emp[[2]]
pmodel4_empv3 <- lposteriorsmodel4_emp[[3]]
pmodel4_empv4 <- lposteriorsmodel4_emp[[4]]


model5_emppred <- model5_emp$predclass
model5_emppost <- model5_emp$posterior

lposteriorsmodel5_emp <- as.list(as.data.frame(model5_emppost))

pmodel5_empv1 <- lposteriorsmodel5_emp[[1]]
pmodel5_empv2 <- lposteriorsmodel5_emp[[2]]
pmodel5_empv3 <- lposteriorsmodel5_emp[[3]]
pmodel5_empv4 <- lposteriorsmodel5_emp[[4]]
pmodel5_empv5 <- lposteriorsmodel5_emp[[5]]

model6_emppred <- model6_emp$predclass
model6_emppost <- model6_emp$posterior

lposteriorsmodel6_emp <- as.list(as.data.frame(model6_emppost))

pmodel6_empv1 <- lposteriorsmodel6_emp[[1]]
pmodel6_empv2 <- lposteriorsmodel6_emp[[2]]
pmodel6_empv3 <- lposteriorsmodel6_emp[[3]]
pmodel6_empv4 <- lposteriorsmodel6_emp[[4]]
pmodel6_empv5 <- lposteriorsmodel6_emp[[5]]
pmodel6_empv6 <- lposteriorsmodel6_emp[[6]]

model7_emppred <- model7_emp$predclass
model7_emppost <- model7_emp$posterior

lposteriorsmodel7_emp <- as.list(as.data.frame(model7_emppost))

pmodel7_empv1 <- lposteriorsmodel7_emp[[1]]
pmodel7_empv2 <- lposteriorsmodel7_emp[[2]]
pmodel7_empv3 <- lposteriorsmodel7_emp[[3]]
pmodel7_empv4 <- lposteriorsmodel7_emp[[4]]
pmodel7_empv5 <- lposteriorsmodel7_emp[[5]]
pmodel7_empv6 <- lposteriorsmodel7_emp[[6]]
pmodel7_empv7 <- lposteriorsmodel7_emp[[7]]

model8_emppred <- model8_emp$predclass
model8_emppost <- model8_emp$posterior

lposteriorsmodel8_emp <- as.list(as.data.frame(model8_emppost))

pmodel8_empv1 <- lposteriorsmodel8_emp[[1]]
pmodel8_empv2 <- lposteriorsmodel8_emp[[2]]
pmodel8_empv3 <- lposteriorsmodel8_emp[[3]]
pmodel8_empv4 <- lposteriorsmodel8_emp[[4]]
pmodel8_empv5 <- lposteriorsmodel8_emp[[5]]
pmodel8_empv6 <- lposteriorsmodel8_emp[[6]]
pmodel8_empv7 <- lposteriorsmodel8_emp[[7]]
pmodel8_empv8 <- lposteriorsmodel8_emp[[8]]

model9_emppred <- model9_emp$predclass
model9_emppost <- model9_emp$posterior

lposteriorsmodel9_emp <- as.list(as.data.frame(model9_emppost))

pmodel9_empv1 <- lposteriorsmodel9_emp[[1]]
pmodel9_empv2 <- lposteriorsmodel9_emp[[2]]
pmodel9_empv3 <- lposteriorsmodel9_emp[[3]]
pmodel9_empv4 <- lposteriorsmodel9_emp[[4]]
pmodel9_empv5 <- lposteriorsmodel9_emp[[5]]
pmodel9_empv6 <- lposteriorsmodel9_emp[[6]]
pmodel9_empv7 <- lposteriorsmodel9_emp[[7]]
pmodel9_empv8 <- lposteriorsmodel9_emp[[8]]
pmodel9_empv9 <- lposteriorsmodel9_emp[[9]]

model10_emppred <- model10_emp$predclass
model10_emppost <- model10_emp$posterior

lposteriorsmodel10_emp <- as.list(as.data.frame(model10_emppost))

pmodel10_empv1 <- lposteriorsmodel10_emp[[1]]
pmodel10_empv2 <- lposteriorsmodel10_emp[[2]]
pmodel10_empv3 <- lposteriorsmodel10_emp[[3]]
pmodel10_empv4 <- lposteriorsmodel10_emp[[4]]
pmodel10_empv5 <- lposteriorsmodel10_emp[[5]]
pmodel10_empv6 <- lposteriorsmodel10_emp[[6]]
pmodel10_empv7 <- lposteriorsmodel10_emp[[7]]
pmodel10_empv8 <- lposteriorsmodel10_emp[[8]]
pmodel10_empv9 <- lposteriorsmodel10_emp[[9]]
pmodel10_empv10 <- lposteriorsmodel10_emp[[10]]

model11_emppred <- model11_emp$predclass
model11_emppost <- model11_emp$posterior

lposteriorsmodel11_emp <- as.list(as.data.frame(model11_emppost))

pmodel11_empv1 <- lposteriorsmodel11_emp[[1]]
pmodel11_empv2 <- lposteriorsmodel11_emp[[2]]
pmodel11_empv3 <- lposteriorsmodel11_emp[[3]]
pmodel11_empv4 <- lposteriorsmodel11_emp[[4]]
pmodel11_empv5 <- lposteriorsmodel11_emp[[5]]
pmodel11_empv6 <- lposteriorsmodel11_emp[[6]]
pmodel11_empv7 <- lposteriorsmodel11_emp[[7]]
pmodel11_empv8 <- lposteriorsmodel11_emp[[8]]
pmodel11_empv9 <- lposteriorsmodel11_emp[[9]]
pmodel11_empv10 <- lposteriorsmodel11_emp[[10]]
pmodel11_empv11 <- lposteriorsmodel11_emp[[11]]

model12_emppred <- model12_emp$predclass
model12_emppost <- model12_emp$posterior

lposteriorsmodel12_emp <- as.list(as.data.frame(model12_emppost))

pmodel12_empv1 <- lposteriorsmodel12_emp[[1]]
pmodel12_empv2 <- lposteriorsmodel12_emp[[2]]
pmodel12_empv3 <- lposteriorsmodel12_emp[[3]]
pmodel12_empv4 <- lposteriorsmodel12_emp[[4]]
pmodel12_empv5 <- lposteriorsmodel12_emp[[5]]
pmodel12_empv6 <- lposteriorsmodel12_emp[[6]]
pmodel12_empv7 <- lposteriorsmodel12_emp[[7]]
pmodel12_empv8 <- lposteriorsmodel12_emp[[8]]
pmodel12_empv9 <- lposteriorsmodel12_emp[[9]]
pmodel12_empv10 <- lposteriorsmodel12_emp[[10]]
pmodel12_empv11 <- lposteriorsmodel12_emp[[11]]
pmodel12_empv12 <- lposteriorsmodel12_emp[[12]]

model13_emppred <- model13_emp$predclass
model13_emppost <- model13_emp$posterior

lposteriorsmodel13_emp <- as.list(as.data.frame(model13_emppost))

pmodel13_empv1 <- lposteriorsmodel13_emp[[1]]
pmodel13_empv2 <- lposteriorsmodel13_emp[[2]]
pmodel13_empv3 <- lposteriorsmodel13_emp[[3]]
pmodel13_empv4 <- lposteriorsmodel13_emp[[4]]
pmodel13_empv5 <- lposteriorsmodel13_emp[[5]]
pmodel13_empv6 <- lposteriorsmodel13_emp[[6]]
pmodel13_empv7 <- lposteriorsmodel13_emp[[7]]
pmodel13_empv8 <- lposteriorsmodel13_emp[[8]]
pmodel13_empv9 <- lposteriorsmodel13_emp[[9]]
pmodel13_empv10 <- lposteriorsmodel13_emp[[10]]
pmodel13_empv11 <- lposteriorsmodel13_emp[[11]]
pmodel13_empv12 <- lposteriorsmodel13_emp[[12]]
pmodel13_empv13 <- lposteriorsmodel13_emp[[13]]

model14_emppred <- model14_emp$predclass
model14_emppost <- model14_emp$posterior

lposteriorsmodel14_emp <- as.list(as.data.frame(model14_emppost))

pmodel14_empv1 <- lposteriorsmodel14_emp[[1]]
pmodel14_empv2 <- lposteriorsmodel14_emp[[2]]
pmodel14_empv3 <- lposteriorsmodel14_emp[[3]]
pmodel14_empv4 <- lposteriorsmodel14_emp[[4]]
pmodel14_empv5 <- lposteriorsmodel14_emp[[5]]
pmodel14_empv6 <- lposteriorsmodel14_emp[[6]]
pmodel14_empv7 <- lposteriorsmodel14_emp[[7]]
pmodel14_empv8 <- lposteriorsmodel14_emp[[8]]
pmodel14_empv9 <- lposteriorsmodel14_emp[[9]]
pmodel14_empv10 <- lposteriorsmodel14_emp[[10]]
pmodel14_empv11 <- lposteriorsmodel14_emp[[11]]
pmodel14_empv12 <- lposteriorsmodel14_emp[[12]]
pmodel14_empv13 <- lposteriorsmodel14_emp[[13]]
pmodel14_empv14 <- lposteriorsmodel14_emp[[14]]
```

```{r, eval=FALSE}
Models_emp <- cbind (volgnumm, model3_emppred	,
                 pmodel3_empv1	,
                 pmodel3_empv2	,
                 pmodel3_empv3	,
                 model4_emppred	,
                 pmodel4_empv1	,
                 pmodel4_empv2	,
                 pmodel4_empv3	,
                 pmodel4_empv4	,
                 model5_emppred	,
                 pmodel5_empv1	,
                 pmodel5_empv2	,
                 pmodel5_empv3	,
                 pmodel5_empv4	,
                 pmodel5_empv5	,
                 model6_emppred	,
                 pmodel6_empv1	,
                 pmodel6_empv2	,
                 pmodel6_empv3	,
                 pmodel6_empv4	,
                 pmodel6_empv5	,
                 pmodel6_empv6	,
                 model7_emppred	,
                 pmodel7_empv1	,
                 pmodel7_empv2	,
                 pmodel7_empv3	,
                 pmodel7_empv4	,
                 pmodel7_empv5	,
                 pmodel7_empv6	,
                 pmodel7_empv7	,
                 model8_emppred	,
                 pmodel8_empv1	,
                 pmodel8_empv2	,
                 pmodel8_empv3	,
                 pmodel8_empv4	,
                 pmodel8_empv5	,
                 pmodel8_empv6	,
                 pmodel8_empv7	,
                 pmodel8_empv8 ,
                 model9_emppred	,
                 pmodel9_empv1	,
                 pmodel9_empv2	,
                 pmodel9_empv3	,
                 pmodel9_empv4	,
                 pmodel9_empv5	,
                 pmodel9_empv6	,
                 pmodel9_empv7	,
                 pmodel9_empv8	,
                 pmodel9_empv9 ,
                 model10_emppred	,
                 pmodel10_empv1 ,
                 pmodel10_empv2 ,
                 pmodel10_empv3 ,
                 pmodel10_empv4 ,
                 pmodel10_empv5 ,
                 pmodel10_empv6 ,
                 pmodel10_empv7 ,
                 pmodel10_empv8 ,
                 pmodel10_empv9 ,
                 pmodel10_empv10 ,
                 model11_emppred	,
                 pmodel11_empv1 ,
                 pmodel11_empv2 ,
                 pmodel11_empv3 ,
                 pmodel11_empv4 ,
                 pmodel11_empv5 ,
                 pmodel11_empv6 ,
                 pmodel11_empv7 ,
                 pmodel11_empv8 ,
                 pmodel11_empv9 ,
                 pmodel11_empv10 ,
                 pmodel11_empv11 ,
                 model12_emppred	,
                 pmodel12_empv1 ,
                 pmodel12_empv2 ,
                 pmodel12_empv3 ,
                 pmodel12_empv4 ,
                 pmodel12_empv5 ,
                 pmodel12_empv6 ,
                 pmodel12_empv7 ,
                 pmodel12_empv8 ,
                 pmodel12_empv9 ,
                 pmodel12_empv10 ,
                 pmodel12_empv11 ,
                 pmodel12_empv12 ,
                 model13_emppred	,
                 pmodel13_empv1 ,
                 pmodel13_empv2 ,
                 pmodel13_empv3 ,
                 pmodel13_empv4 ,
                 pmodel13_empv5 ,
                 pmodel13_empv6 ,
                 pmodel13_empv7 ,
                 pmodel13_empv8 ,
                 pmodel13_empv9 ,
                 pmodel13_empv10 ,
                 pmodel13_empv11 ,
                 pmodel13_empv12 ,
                 pmodel13_empv13 ,
                 model14_emppred	,
                 pmodel14_empv1 ,
                 pmodel14_empv2 ,
                 pmodel14_empv3 ,
                 pmodel14_empv4 ,
                 pmodel14_empv5 ,
                 pmodel14_empv6 ,
                 pmodel14_empv7 ,
                 pmodel14_empv8 ,
                 pmodel14_empv9 ,
                 pmodel14_empv10 ,
                 pmodel14_empv11 ,
                 pmodel14_empv12 ,
                 pmodel14_empv13 ,
                 pmodel14_empv14 )
```


```{r}
max_probs <- apply(model7_emppost, 1, max)
```

```{r}
mean(max_probs)
median(max_probs)
min(max_probs)
max(max_probs)
```
```{r}
K <- 7  # aantal klassen

mean_posteriors <- numeric(K)

for (k in 1:K) {
  idx <- which(model7_emppred == k)
  mean_posteriors[k] <- mean(model7_emppost[idx, k])
}

names(mean_posteriors) <- paste0("Class", 1:K)

mean_posteriors

```









































```{r}
poLCA.entropy <- function(model) {
  P <- model$posterior
  entropy <- sum(-P * log(P), na.rm=TRUE) / (nrow(P) * log(ncol(P)))
  return(1 - entropy)
}
poLCA.entropy(model2_emp)
```
```{r}
poLCA.entropy <- function(model) {
  P <- model$posterior
  entropy <- sum(-P * log(P), na.rm=TRUE) / (nrow(P) * log(ncol(P)))
  return(1 - entropy)
}
poLCA.entropy(model3_emp)
```
```{r}
poLCA.entropy <- function(model) {
  P <- model$posterior
  entropy <- sum(-P * log(P), na.rm=TRUE) / (nrow(P) * log(ncol(P)))
  return(1 - entropy)
}
poLCA.entropy(model4_emp)
```
```{r}
poLCA.entropy <- function(model) {
  P <- model$posterior
  entropy <- sum(-P * log(P), na.rm=TRUE) / (nrow(P) * log(ncol(P)))
  return(1 - entropy)
}
poLCA.entropy(model5_emp)
```
```{r}
poLCA.entropy <- function(model) {
  P <- model$posterior
  entropy <- sum(-P * log(P), na.rm=TRUE) / (nrow(P) * log(ncol(P)))
  return(1 - entropy)
}
poLCA.entropy(model6_emp)
```

```{r}
poLCA.entropy <- function(model) {
  P <- model$posterior
  entropy <- sum(-P * log(P), na.rm=TRUE) / (nrow(P) * log(ncol(P)))
  return(1 - entropy)
}
poLCA.entropy(model7_emp)
```

```{r}
poLCA.entropy <- function(model) {
  P <- model$posterior
  entropy <- sum(-P * log(P), na.rm=TRUE) / (nrow(P) * log(ncol(P)))
  return(1 - entropy)
}
poLCA.entropy(model8_emp)
```
```{r}
poLCA.entropy <- function(model) {
  P <- model$posterior
  entropy <- sum(-P * log(P), na.rm=TRUE) / (nrow(P) * log(ncol(P)))
  return(1 - entropy)
}
poLCA.entropy(model9_emp)
```

```{r}
poLCA.entropy <- function(model) {
  P <- model$posterior
  entropy <- sum(-P * log(P), na.rm=TRUE) / (nrow(P) * log(ncol(P)))
  return(1 - entropy)
}
poLCA.entropy(model10_emp)
```
```{r}
poLCA.entropy <- function(model) {
  P <- model$posterior
  entropy <- sum(-P * log(P), na.rm=TRUE) / (nrow(P) * log(ncol(P)))
  return(1 - entropy)
}
poLCA.entropy(model11_emp)
```
```{r}
poLCA.entropy <- function(model) {
  P <- model$posterior
  entropy <- sum(-P * log(P), na.rm=TRUE) / (nrow(P) * log(ncol(P)))
  return(1 - entropy)
}
poLCA.entropy(model12_emp)
```
```{r}
poLCA.entropy <- function(model) {
  P <- model$posterior
  entropy <- sum(-P * log(P), na.rm=TRUE) / (nrow(P) * log(ncol(P)))
  return(1 - entropy)
}
poLCA.entropy(model13_emp)
```
```{r}
# Get predicted class for each person (highest posterior prob)
assigned_class <- apply(model2_emp$posterior, 1, which.max)

# Get number of classes
K <- ncol(model2_emp$posterior)

# Initialize AvePP vector
avepp <- numeric(K)

# Loop through each class to compute AvePP
for (k in 1:K) {
  class_members <- which(assigned_class == k)
  avepp[k] <- mean(model2_emp$posterior[class_members, k])
}

# Print the AvePP per class
round(avepp, 3)
```
```{r}
# Get predicted class for each person (highest posterior prob)
assigned_class <- apply(model3_emp$posterior, 1, which.max)

# Get number of classes
K <- ncol(model3_emp$posterior)

# Initialize AvePP vector
avepp <- numeric(K)

# Loop through each class to compute AvePP
for (k in 1:K) {
  class_members <- which(assigned_class == k)
  avepp[k] <- mean(model3_emp$posterior[class_members, k])
}

# Print the AvePP per class
round(avepp, 3)
```
```{r}
# Get predicted class for each person (highest posterior prob)
assigned_class <- apply(model4_emp$posterior, 1, which.max)

# Get number of classes
K <- ncol(model4_emp$posterior)

# Initialize AvePP vector
avepp <- numeric(K)

# Loop through each class to compute AvePP
for (k in 1:K) {
  class_members <- which(assigned_class == k)
  avepp[k] <- mean(model4_emp$posterior[class_members, k])
}

# Print the AvePP per class
round(avepp, 3)
```
```{r}
# Get predicted class for each person (highest posterior prob)
assigned_class <- apply(model5_emp$posterior, 1, which.max)

# Get number of classes
K <- ncol(model5_emp$posterior)

# Initialize AvePP vector
avepp <- numeric(K)

# Loop through each class to compute AvePP
for (k in 1:K) {
  class_members <- which(assigned_class == k)
  avepp[k] <- mean(model5_emp$posterior[class_members, k])
}

# Print the AvePP per class
round(avepp, 3)
```
```{r}
# Get predicted class for each person (highest posterior prob)
assigned_class <- apply(model6_emp$posterior, 1, which.max)

# Get number of classes
K <- ncol(model6_emp$posterior)

# Initialize AvePP vector
avepp <- numeric(K)

# Loop through each class to compute AvePP
for (k in 1:K) {
  class_members <- which(assigned_class == k)
  avepp[k] <- mean(model6_emp$posterior[class_members, k])
}

# Print the AvePP per class
round(avepp, 3)
```

```{r}
# Get predicted class for each person (highest posterior prob)
assigned_class <- apply(model7_emp$posterior, 1, which.max)

# Get number of classes
K <- ncol(model7_emp$posterior)

# Initialize AvePP vector
avepp <- numeric(K)

# Loop through each class to compute AvePP
for (k in 1:K) {
  class_members <- which(assigned_class == k)
  avepp[k] <- mean(model7_emp$posterior[class_members, k])
}

# Print the AvePP per class
round(avepp, 3)

```
```{r}
# Get predicted class for each person (highest posterior prob)
assigned_class <- apply(model8_emp$posterior, 1, which.max)

# Get number of classes
K <- ncol(model8_emp$posterior)

# Initialize AvePP vector
avepp <- numeric(K)

# Loop through each class to compute AvePP
for (k in 1:K) {
  class_members <- which(assigned_class == k)
  avepp[k] <- mean(model8_emp$posterior[class_members, k])
}

# Print the AvePP per class
round(avepp, 3)
```

```{r}
# Get predicted class for each person (highest posterior prob)
assigned_class <- apply(model9_emp$posterior, 1, which.max)

# Get number of classes
K <- ncol(model9_emp$posterior)

# Initialize AvePP vector
avepp <- numeric(K)

# Loop through each class to compute AvePP
for (k in 1:K) {
  class_members <- which(assigned_class == k)
  avepp[k] <- mean(model9_emp$posterior[class_members, k])
}

# Print the AvePP per class
round(avepp, 3)
```

```{r}
# Get predicted class for each person (highest posterior prob)
assigned_class <- apply(model10_emp$posterior, 1, which.max)

# Get number of classes
K <- ncol(model10_emp$posterior)

# Initialize AvePP vector
avepp <- numeric(K)

# Loop through each class to compute AvePP
for (k in 1:K) {
  class_members <- which(assigned_class == k)
  avepp[k] <- mean(model10_emp$posterior[class_members, k])
}

# Print the AvePP per class
round(avepp, 3)
```

```{r}
# Get predicted class for each person (highest posterior prob)
assigned_class <- apply(model11_emp$posterior, 1, which.max)

# Get number of classes
K <- ncol(model11_emp$posterior)

# Initialize AvePP vector
avepp <- numeric(K)

# Loop through each class to compute AvePP
for (k in 1:K) {
  class_members <- which(assigned_class == k)
  avepp[k] <- mean(model11_emp$posterior[class_members, k])
}

# Print the AvePP per class
round(avepp, 3)
```

```{r}
# Get predicted class for each person (highest posterior prob)
assigned_class <- apply(model12_emp$posterior, 1, which.max)

# Get number of classes
K <- ncol(model12_emp$posterior)

# Initialize AvePP vector
avepp <- numeric(K)

# Loop through each class to compute AvePP
for (k in 1:K) {
  class_members <- which(assigned_class == k)
  avepp[k] <- mean(model12_emp$posterior[class_members, k])
}

# Print the AvePP per class
round(avepp, 3)
```

```{r}
# Get predicted class for each person (highest posterior prob)
assigned_class <- apply(model13_emp$posterior, 1, which.max)

# Get number of classes
K <- ncol(model13_emp$posterior)

# Initialize AvePP vector
avepp <- numeric(K)

# Loop through each class to compute AvePP
for (k in 1:K) {
  class_members <- which(assigned_class == k)
  avepp[k] <- mean(model13_emp$posterior[class_members, k])
}

# Print the AvePP per class
round(avepp, 3)
```